# Logo Detection

This project aims to detect Pepsi and Coca-Cola logos in video files using the YOLOv8 object detection model. The pipeline extracts frames from the video, processes them with the YOLOv8 model, and outputs the timestamps of detected logos in a JSON format.

## Table of Contents

- [Installation](#installation)
- [Usage](#usage)
- [Project Structure](#project-structure)
- [Dependencies](#dependencies)
- [Example Output](#example-output)
- [Approach](#approach)
- [Future Plans](#future-plans)
- [Possible Features](#possible-features)

## Installation

### Setup the Codebase

1. **Clone the Repository:**

    ```bash
    git clone https://github.com/honestlyBroke/logo-detection
    cd logo-detection
    ```

2. **Create and Activate a Virtual Environment:**

    ```bash
    python3 -m venv .venv
    source .venv/bin/activate
    ```

3. **Install Dependencies:**

    ```bash
    pip install -r requirements.txt
    ```

4. **Resolve Potential Issues:**

    If you encounter issues related to `libgl`, install it using the following commands:

    ```bash
    sudo apt-get update
    sudo apt-get install libgl1-mesa-glx
    ```

5. **Train the Model (if applicable):**

    Due to lack of GPU resources, the model was trained on Google Colab. Detailed training steps are covered in `train-model.md`. For your own trained model, replace `model/logo-detect.pt` with your model file.

## Usage

### Run the Pipeline

The pipeline processes a video file (MP4 format) and outputs a JSON file with the timestamps of detected Pepsi and Coca-Cola logos.

1. **Place Your Video File in the Project Directory.**

2. **Run the Pipeline:**

    ```bash
    python src/main.py <your_video_path.mp4>
    ```

    The output will be saved as `output.json` in the project directory. It will include timestamps, sizes, and distances from the center of detected logos.

### Run using Gradio UI

1. **Start the Gradio Application:**

    ```bash
    python src/app.py
    ```

2. **Upload Your Video in the Gradio Interface.**

3. **View the Output JSON:**

    The result will be displayed on the web interface, showing detected logo timestamps and details.

## Project Structure

```plaintext
logo-detection/
│
├── model/
│   └── logo-detect.pt
│
├── src/
│   ├── __init__.py
│   ├── utils.py
│   ├── model.py
│   ├── frame_processing.py
│   ├── video_processing.py
│   ├── main.py
│   └── app.py
│
└── app.log
```

- **`model/`**: Contains the trained YOLOv8 model (`logo-detect.pt`).
- **`src/`**: Contains the source code, including scripts for video processing, frame processing, and the Gradio app.
- **`app.log`**: Log file generated by `loguru`.

## Dependencies

- Python 3.8+
- `av` - For video processing
- `ultralytics` - For YOLOv8 object detection
- `gradio` - For web interface

## Example Output

The output JSON file format:

```json
{
    "Pepsi_pts": [
        "00:01:23",
        "00:02:34",
        "00:03:45"
        // List of timestamps (HH:MM:SS) when Pepsi logos were detected
    ],
    "CocaCola_pts": [
        "00:05:12",
        "00:07:20",
        "00:08:45"
        // List of timestamps (HH:MM:SS) when CocaCola logos were detected
    ],
    "Pepsi_details": [
        {
            "timestamp": "00:01:23",
            "size": {
                "width": 50,
                "height": 30
            },
            "distance_from_center": 15.3
        }
        // More Pepsi details
    ],
    "CocaCola_details": [
        {
            "timestamp": "00:05:12",
            "size": {
                "width": 60,
                "height": 40
            },
            "distance_from_center": 10.0
        }
        // More CocaCola details
    ]
}
```

## Approach

- **Extract Frames**: Use the `av` library to extract frames from the video.
- **YOLOv8 Detection**: Load the trained YOLOv8 model and run it on the extracted frames.
- **Generate Output**: Collect timestamps of frames where logos are detected and save them in a JSON file.

## Future Plans

- **Improve Detection Accuracy**: Training a better version of the model for better accuracy.
- **Support Additional Logos**: Extend the functionality to detect other brand logos and provide a more comprehensive detection tool.

## Possible Features

- **Real-Time Video Processing**: Implement real-time video processing for immediate logo detection.
- **Enhanced Visualization**: Create visualizations of detected logos on video frames for better analysis.
- **User Feedback Integration**: Allow users to provide feedback on detection results to improve the model's performance.
- **Multi-Logo Detection**: Extend the model to detect and distinguish between a wider range of logos.

Feel free to contribute or suggest improvements!